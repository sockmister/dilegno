/*!
   Kwicks: Sexy Sliding Panels for jQuery - v2.1.0
   http://devsmash.com/projects/kwicks
 
   Copyright 2013 Jeremy Martin (jmar777)
   Contributors: Duke Speer (Duke3D)
   Released under the MIT license
   http://www.opensource.org/licenses/mit-license.php
 */(function($){var methods={init:function(opts){var defaults={maxSize:-1,minSize:-1,spacing:5,duration:500,isVertical:false,easing:undefined,behavior:null,autoResize:true};var o=$.extend(defaults,opts);if(o.minSize!==-1&&o.maxSize!==-1)
throw new Error('Kwicks options minSize and maxSize may not both be set');if(o.behavior&&o.behavior!=='menu')
throw new Error('Unrecognized Kwicks behavior specified: '+o.behavior);$.each(['minSize','maxSize'],function(i,prop){var val=o[prop];switch(typeof val){case'number':o[prop+'Units']='px';break;case'string':if(val.slice(-1)==='%'){o[prop+'Units']='%';o[prop]=+val.slice(0,-1)/100;}else if(val.slice(-2)==='px'){o[prop+'Units']='px';o[prop]=+val.slice(0,-2);}else{throw new Error('Invalid value for Kwicks option '+prop+': '+val);}
break;default:throw new Error('Invalid value for Kwicks option '+prop+': '+val);}});return this.each(function(){$(this).data('kwicks',new Kwick(this,o));});},expand:function(index){return this.each(function(){var $this=$(this),$panel;if($this.is('.kwicks-processed')){if(typeof index!=='number')
throw new Error('Kwicks method "expand" requires an index');if(index>=0)$panel=$this.children().eq(index);}
else if($this.parent().is('.kwicks-processed')){$panel=$this;index=$panel.index();}
else{throw new Error('Cannot call "expand" method on a non-Kwicks element');}
var $target=($panel&&$panel.length)?$panel:$this;$target.trigger('expand.kwicks',{index:index});});},expanded:function(){var kwick=this.first().data('kwicks');if(!kwick)throw new Error('Cannot called "expanded" method on a non-Kwicks element');return kwick.expandedIndex;},select:function(index){return this.each(function(){var $this=$(this),$panel;if($this.is('.kwicks-processed')){if(typeof index!=='number')
throw new Error('Kwicks method "select" requires an index');if(index>=0)$panel=$this.children().eq(index);}
else if($this.parent().is('.kwicks-processed')){$panel=$this;index=$panel.index();}
else{throw new Error('Cannot call "expand" method on a non-Kwicks element');}
var $target=($panel&&$panel.length)?$panel:$this;$target.trigger('select.kwicks',{index:index});});},selected:function(){var kwick=this.first().data('kwicks');if(!kwick)throw new Error('Cannot called "selected" method on a non-Kwicks element');return kwick.selectedIndex;},resize:function(index){return this.each(function(){var $this=$(this),kwick=$this.data('kwicks');if(!kwick){throw new Error('Cannot called "resize" method on a non-Kwicks element');}
kwick.resize();});}};$.fn.kwicks=function(opts){if(methods[opts]){return methods[opts].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof opts==='object'||!opts){return methods.init.apply(this,arguments);}else{throw new Error('Unrecognized kwicks method: '+opts);}};$.event.special.expand={_default:function(e,data){if(e.namespace!=='kwicks')return;var $el=$(e.target);var kwick=$el.data('kwicks')||$el.parent().data('kwicks');if(!kwick)return;kwick.expand(data.index);}};$.event.special.select={_default:function(e,data){if(e.namespace!=='kwicks')return;var $el=$(e.target);var kwick=$el.data('kwicks')||$el.parent().data('kwicks');if(!kwick)return;kwick.select(data.index);}};var Kwick=function Kwick(container,opts){this.opts=opts;var orientation=opts.isVertical?'vertical':'horizontal';this.$container=$(container).addClass('kwicks').addClass('kwicks-'+orientation);this.$panels=this.$container.children();this.selectedIndex=this.$panels.filter('.kwicks-selected').index();this.expandedIndex=this.selectedIndex;this.primaryDimension=opts.isVertical?'height':'width';this.secondaryDimension=opts.isVertical?'width':'height';this.calculatePanelSizes();this.primaryAlignment=opts.isVertical?'top':'left';this.secondaryAlignment=opts.isVertical?'bottom':'right';this.$timer=$({progress:0});this.offsets=this.getOffsetsForExpanded();this.initStyles();this.initBehavior();this.initWindowResizeHandler();};Kwick.prototype.calculatePanelSizes=function(){var opts=this.opts,numPanels=this.$panels.length,containerSize=this.getContainerSize(true),sumSpacing=opts.spacing*(numPanels-1),sumPanelSize=containerSize-sumSpacing;this.panelSize=sumPanelSize/numPanels;if(opts.minSize===-1){if(opts.maxSize===-1){if(numPanels<5){this.panelMaxSize=containerSize/3*2;}else{this.panelMaxSize=containerSize/3;}}else if(opts.maxSizeUnits==='%'){this.panelMaxSize=sumPanelSize*opts.maxSize;}else{this.panelMaxSize=opts.maxSize;}
this.panelMinSize=(sumPanelSize-this.panelMaxSize)/(numPanels-1);}else if(opts.maxSize===-1){if(opts.minSizeUnits==='%'){this.panelMinSize=sumPanelSize*opts.minSize;}else{this.panelMinSize=opts.minSize;}
this.panelMaxSize=sumPanelSize-(this.panelMinSize*(numPanels-1));}};Kwick.prototype.getOffsetsForExpanded=function(){var expandedIndex=this.expandedIndex,numPanels=this.$panels.length,spacing=this.opts.spacing,size=this.panelSize,minSize=this.panelMinSize,maxSize=this.panelMaxSize;var offsets=[0];for(var i=1;i<numPanels;i++){if(expandedIndex===-1){offsets[i]=i*(size+spacing);}
else if(i<=expandedIndex){offsets[i]=i*(minSize+spacing);}
else{offsets[i]=maxSize+(minSize*(i-1))+(i*spacing);}}
return offsets;};Kwick.prototype.setStyle=(function(){if($.support.style){return function(el,style){el.setAttribute('style',style);};}else{return function(el,style){el.style.cssText=style;};}})();Kwick.prototype.updatePanelStyles=function(){var offsets=this.offsets,$panels=this.$panels,pDim=this.primaryDimension,pAlign=this.primaryAlignment,sAlign=this.secondaryAlignment,spacing=this.opts.spacing,containerSize=this.getContainerSize();var stylePrefix=!!this._stylesInited?'':'position:absolute;',offset,size,prevOffset,style;for(var i=$panels.length;i--;){prevOffset=offset;offset=Math.round(offsets[i]);if(i===$panels.length-1){size=containerSize-offset;style=sAlign+':0;'+pDim+':'+size+'px;';}else{size=prevOffset-offset-spacing;style=pAlign+':'+offset+'px;'+pDim+':'+size+'px;';}
this.setStyle($panels[i],stylePrefix+style);}
if(!this._stylesInited){this.$container.addClass('kwicks-processed');this._stylesInited=true;}};Kwick.prototype.initStyles=function(){var opts=this.opts,$container=this.$container,$panels=this.$panels,numPanels=$panels.length,pDim=this.primaryDimension,sDim=this.secondaryDimension;this.updatePanelStyles();};Kwick.prototype.initBehavior=function(){if(!this.opts.behavior)return;var $container=this.$container;switch(this.opts.behavior){case'menu':this.$container.on('mouseleave',function(){$container.kwicks('expand',-1);}).children().on('mouseover',function(){$(this).kwicks('expand');}).click(function(){$(this).kwicks('select');});break;default:throw new Error('Unrecognized behavior option: '+this.opts.behavior);}};Kwick.prototype.initWindowResizeHandler=function(){if(!this.opts.autoResize)return;var self=this,prevTime=0,execScheduled=false;var onResize=function(e){if(!e){execScheduled=false;}
var now=+new Date();if(now-prevTime<20){if(execScheduled)return;setTimeout(onResize,20-(now-prevTime));execScheduled=true;return;}
prevTime=now;self.resize();}
$(window).on('resize',onResize);};Kwick.prototype.getContainerSize=function(clearCache){var containerSize=this._containerSize;if(clearCache||!containerSize){containerSize=this._containerSize=this.$container[this.primaryDimension]();}
return containerSize;};Kwick.prototype.getExpandedPanel=function(){return this.expandedIndex===-1?$([]):this.$panels.eq(this.expandedIndex);};Kwick.prototype.getCollapsedPanels=function(){return this.expandedIndex===-1?$([]):this.$panels.not(this.getExpandedPanel());};Kwick.prototype.getSelectedPanel=function(){return this.selectedIndex===-1?$([]):this.$panels.eq(this.selectedIndex);};Kwick.prototype.resize=function(index){if(this.getContainerSize()===this.getContainerSize(true))return;this.calculatePanelSizes();this.offsets=this.getOffsetsForExpanded();if(this.isAnimated){this._dirtyOffsets=true;}else{this.updatePanelStyles();}};Kwick.prototype.select=function(index){if(index===this.selectedIndex){return this.expand(index);}
this.getSelectedPanel().removeClass('kwicks-selected');this.selectedIndex=index;this.getSelectedPanel().addClass('kwicks-selected');this.expand(index);};Kwick.prototype.expand=function(index){var self=this;if(index===-1)index=this.selectedIndex;if(index===this.expandedIndex)return;this.getExpandedPanel().removeClass('kwicks-expanded');this.getCollapsedPanels().removeClass('kwicks-collapsed');this.expandedIndex=index;this.getExpandedPanel().addClass('kwicks-expanded');this.getCollapsedPanels().addClass('kwicks-collapsed');var $timer=this.$timer,numPanels=this.$panels.length,startOffsets=this.offsets.slice(),offsets=this.offsets,targetOffsets=this.getOffsetsForExpanded();$timer.stop()[0].progress=0;this.isAnimated=true;$timer.animate({progress:1},{duration:this.opts.duration,easing:this.opts.easing,step:function(progress){if(self._dirtyOffsets){offsets=self.offsets;targetOffsets=self.getOffsetsForExpanded();self._dirtyOffsets=false;}
offsets.length=0;for(var i=0;i<numPanels;i++){var targetOffset=targetOffsets[i],newOffset=targetOffset-((targetOffset-startOffsets[i])*(1-progress));offsets[i]=newOffset;}
self.updatePanelStyles();},complete:function(){self.isAnimated=false;}});};})(jQuery);